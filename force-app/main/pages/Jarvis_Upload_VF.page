<apex:page standardController="Apttus_Proposal__Proposal__c" Extensions="jarvisUploadController"  >
<html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" lang="en">
 <head>
    <style>
.messageTable td {
    width:2.2px;
}     
 
.controlPanel td{
    width:200px;
}
.controlPanel{
    margin-top:20px;
}
.popupBackground {
    background-color: black;
    opacity: 0.10;
    filter: alpha(opacity=10);
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 9998;
}
p {
    text-align: left;
    color: black;
}
body{ 
    padding-left: 30px;
} 
.slds-scope .slds-panel__section {
    padding:0.5rem;
}

.filetyp{
    display:none;
}

    </style>
      
     <script>
     
    </script> 
    
 </head>
 <body>
<apex:slds />
<apex:form rendered="{!hasAggregation}">
      <!-- <font color="red">
        <br></br>
        <apex:outputText style="font-weight:600" value="The cart is in Read-Only mode, as this quote contains Site Aggregation. JARVIS upload is not permitted.">
        </apex:outputText>
      </font> -->

      <div class="slds-panel__section">
        <font color="red">
          <br></br>
          <apex:outputText style="font-weight:600" value="The cart is in Read-Only mode, as this quote contains Site Aggregation. JARVIS upload is not permitted.">
          </apex:outputText>
        </font>
        <br></br>
        <apex:commandButton value="Close" action="{!close}" style="margin-top:5px;left:0px;position:relative;" />
      </div>
    </apex:form>
     
<div class = "slds-scope">
        <apex:form rendered="{!hasAggregation == false}">
            
                <apex:pagemessages id="errorMsgID"   />
            
                <center> 
                   <apex:actionStatus id="importProdutsfromfile" stopText="" rendered="{!csvFileBody != null}">
                    <apex:facet name="start">
                    <div class="demo-only demo--inverse" style="height:0rem;margin-bottom: -30px;">
                        <div class="slds-spinner_container">
                          <div role="status" class="slds-spinner slds-spinner_medium">
                                <span class="slds-assistive-text">Reading From File ...</span>
                                <div class="slds-spinner__dot-a"></div>
                                <div class="slds-spinner__dot-b"></div>
                                <p style="transform: translate(-32%, -50%) rotate(-90deg);width: 320px;text-align: center;"> Reading From File ... </p>
                          </div>
                        </div>
                    </div> 
                    </apex:facet>
                    </apex:actionStatus>
                    
                    <apex:actionStatus id="Createcart" stopText="" rendered="{!csvFileBody != null}">
                    <apex:facet name="start">
                      <div class="demo-only demo--inverse" style="height:0rem;margin-bottom: -40px;">
                        <div class="slds-spinner_container">
                          <div role="status" class="slds-spinner slds-spinner_medium">
                                <span class="slds-assistive-text">Creating Cart ...</span>
                                <div class="slds-spinner__dot-a"></div>
                                <div class="slds-spinner__dot-b"></div>
                                <p style="transform: translate(-32%, -50%) rotate(-90deg);width: 320px;text-align: center;"> Creating Cart ... </p>
                          </div>
                        </div>
                     </div> 
                    </apex:facet>
                    </apex:actionStatus>
                    
                    <apex:actionStatus id="addProductsfromfile" stopText="" rendered="{!csvFileBody != null}">
                    <apex:facet name="start">
                    <div class="demo-only demo--inverse" style="height:0rem;margin-bottom: -30px;">
                        <div class="slds-spinner_container">
                          <div role="status" class="slds-spinner slds-spinner_medium">
                                <span class="slds-assistive-text">Adding Products to Cart ...</span>
                                <div class="slds-spinner__dot-a"></div>
                                <div class="slds-spinner__dot-b"></div>
                                <p style="transform: translate(-32%, -50%) rotate(-90deg);width: 320px;text-align: center;"> Adding Products to Cart ...</p>
                          </div>
                        </div>
                    </div> 
                    </apex:facet>
                    </apex:actionStatus>
                    
                     <apex:actionStatus id="Reprice" stopText="" rendered="true">
                    <apex:facet name="start">
                    <div class="demo-only demo--inverse" style="height:0rem;margin-bottom: -30px;">
                        <div class="slds-spinner_container">
                          <div role="status" class="slds-spinner slds-spinner_medium">
                                <span class="slds-assistive-text">Repricing Cart ...</span>
                                <div class="slds-spinner__dot-a"></div>
                                <div class="slds-spinner__dot-b"></div>
                                <p style="transform: translate(-32%, -50%) rotate(-90deg);width: 320px;text-align: center;"> Repricing Cart ...</p>
                          </div>
                        </div>
                    </div> 
                    </apex:facet>
                    </apex:actionStatus>

                    
                    <apex:actionStatus id="Saveconfig" stopText="" rendered="{!csvFileBody != null}">
                    <apex:facet name="start">
                    <div class="demo-only demo--inverse" style="height:0rem;margin-bottom: -30px;">
                        <div class="slds-spinner_container">
                          <div role="status" class="slds-spinner slds-spinner_medium">
                                <span class="slds-assistive-text">Saving Cart ...</span>
                                <div class="slds-spinner__dot-a"></div>
                                <div class="slds-spinner__dot-b"></div>
                                <p style="transform: translate(-32%, -50%) rotate(-90deg);width: 320px;text-align: center;"> Saving Cart ...</p>
                          </div>
                        </div>
                    </div> 
                    </apex:facet>
                    </apex:actionStatus>
                </center>

               <apex:outputPanel styleClass="slds-panel slds-grid slds-grid--vertical slds-nowrap slds-form--compound">
                <table class="controlPanel fromFile">  
                 
                        <div class="slds-panel__section"> <b class ="slds-text-heading_medium">Upload a Jarvis CSV file(Max 125 lines)</b>
                        </div>
                     
                      
                    <div class="slds-panel__section">
                    <div>
                      <p>
                        <b>If you want to edit the contents of the JARVIS file, please edit in a text editor(Notepad) or make adjustments in the cart.</b>
                      </p>
                      <p>
                        <b>Please do not make edits to the file in Excel.</b>
                      </p>
                    </div>
                    <tr>                
                    <p><b>1. Select the file </b></p>
                    <!-->      <p><font color = "red"> <b>ATTENTION: Please do not upload future products</b></font></p> -->
                           <div class="slds-file-selector slds-file-selector_files">
                            <div class="slds-file-selector__dropzone" >
                        <p class="filetyp"><apex:inputFile value="{!csvFileBody}" filename="{!csvAsString}" onchange="dosetFile();"  id="fileUploadInput01"/></p>
                               <apex:outputLabel styleClass="slds-file-selector__body" for="fileUploadInput01" >
                               <span>Upload CSV file :</span> &nbsp;&nbsp;
                              <span class="slds-file-selector__button slds-button slds-button_neutral">
                                <svg class="slds-button__icon slds-button__icon_left" aria-hidden="true">
                                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#upload"></use>
                                </svg>Upload File</span>
                                </apex:outputLabel>
                             </div>
                            </div>
                        <apex:actionFunction action="{!setFile}" name="dosetFile" status="importProdutsfromfile" /> 
                     </tr>
                     
                     </div> 
                     <div class="slds-panel__section">
                     <tr> <p><b>File Loaded : {!csvAsString}</b></p></tr>
                       </div> 
                       
                     <div class="slds-panel__section">  
                     
                     <apex:actionregion >
                     <tr>
                       <p><b>2. Click the import Products button to upload products</b></p>                                        
                       <apex:outputPanel id="Mypanel"> 
                        <apex:commandButton value="Cancel"  action="{!close}"  style="left:0px;position:relative;"/>     
                       <apex:commandButton id="importButton" value="Import Products" onclick="importProdutsfromfile();return false;" disabled="{!isCSV}" style="left:+15px;position:relative;"/>
                       
                       <apex:actionFunction action="{!importProdutsfromfile}" name="importProdutsfromfile"  rerender="errorMsgID"  oncomplete="docreatecart();return false;" status="importProdutsfromfile" />
                       <apex:actionFunction action="{!createcart}" name="docreatecart" oncomplete="doaddProductsfromfile();return false;" rerender="errorMsgID" status="Createcart" />
                    
                       <apex:outputpanel > 
                            <apex:actionFunction action="{!addProductsfromfile}" name="doaddProductsfromfile" oncomplete="dosave();return false;" rerender="errorMsgID" status="addProductsfromfile" />
                            <apex:actionFunction action="{!Saveconfig}" name="dosave" rerender="errorMsgID,importButton,output1" status="Saveconfig" />
                       </apex:outputpanel> 
                      
                       </apex:outputPanel>                                        
                       
                       </tr>
                       </apex:actionregion>
                       </div>   
                            
                            
                      <div class="slds-panel__section"> 
                      <tr>
                         <p><b>3. Click the close button to go to Quote Or Go to Cart button to go to Cart</b></p>
                           <div >
                         <apex:commandButton value="Close"  action="{!close}"  style="left:0px;position:relative;"/>
                         <apex:commandButton value="Close & Abandon"  action="{!returntoquote}"  style="left:+10px;position:relative;"/>
                        <apex:commandButton value="Go to Cart"  action="{!goToCart}" style="left:+20px;position:relative;"/>
                          </div> 
                      </tr>
                         
                            
                      </div>
                   <!-->   <div class="slds-panel__section">
                      <tr> <p><b>Uploaded Files : </b></p></tr>
                      </div>
                      <apex:outputText id="output1" value="{!priorUploadedFiles}">
                        
                      </apex:outputText> -->
                    
                  </table>

                        </apex:outputPanel>              
                 
                      
        </apex:form> 
        
     </div>   
   </body>
  </html>
</apex:page>