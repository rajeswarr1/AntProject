<!--
  @description       : 
  @author            : Yashdeep Prajapati
  @group             : 
  @last modified on  : 10-05-2021
  @last modified by  : Yashdeep Prajapati
  Modifications Log 
  Ver   Date         Author               Modification
  1.0   06-25-2021   Yashdeep Prajapati   Initial Version
-->
<aura:component controller="BulkUploadCustomProducts_Controller">
    <aura:attribute name="configId" type="String" />
    <aura:attribute name="templateId" type="String" />
    <aura:attribute name="error" type="String" />
    <aura:attribute name="error2" type="String" />
    <aura:attribute name="csvAsString" type="String" />
    <aura:attribute name="csvFileBody" type="String" />
    <aura:attribute name="templateURL" type="String" />
    <aura:attribute name="has_error" type="Boolean" default="false" />
    <aura:attribute name="has_error2" type="Boolean" default="false" />
    <aura:attribute name="success" type="Boolean" default="false" />
    <aura:attribute name="showModal2" type="Boolean" default="false" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:attribute name="showSpinner" type="Boolean" default="true" />
    <aura:attribute name="showSpinner2" type="Boolean" default="false" />
    <aura:attribute name="subPortfolio" type="String" default="" />

    <aura:if isTrue="{!v.showSpinner}">
        <lightning:spinner alternativeText="Loading ..." />
    </aura:if>
    <aura:if isTrue="{!v.showSpinner2}">
        <lightning:spinner alternativeText="Importing Products ..." />
    </aura:if>
    <aura:if isTrue="{!v.showModal2}">
        <div class="demo-only" style="height: 940px;">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Upload a CSV file to
                            save its contents as Custom Product records</h2>

                        <div class="slds-panel__section">
                            <lightning:formattedUrl value="{!v.templateId}" label="Download CSV Template File"
                                target="_blank" />
                        </div>
                        <div>
                            <p><b>If you are using MAC, please save the file as a Windows CSV</b></p>
                        </div>
                        <aura:if isTrue="{!v.has_error}">
                            <div class="slds-text-align_left">
                                <ui:message title="Error" severity="error" closable="true">
                                    <aura:unescapedHtml value="{!v.error}"></aura:unescapedHtml>
                                </ui:message>
                            </div>
                            <br></br>
                        </aura:if>
                        <aura:if isTrue="{!v.has_error2}">
                            <ui:message title="Information" severity="info" closable="true">
                                Products Loaded Successfully !<br></br>Product Discount % has been ignored as it is not
                                applicable for this quote type
                            </ui:message>
                            <br></br>
                        </aura:if>
                        <aura:if isTrue="{!v.success}">
                            <ui:message title="Confirmation" severity="confirm" closable="true">
                                Products loaded successfully..
                            </ui:message>
                        </aura:if>

                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <p><b>1. Select the file </b></p>
                        <p style="margin-left: 12px;color: #ec6200;"><b>Note: </b>{!$Label.c.BulkCustomProductNote}</p>
                        <aura:if isTrue="{!v.subPortfolio != null}">
                            <p style="margin-left: 12px;color: #ec6200;"><b>Please associate each Custom Product with one of the following Accredited Solutions:<br/>{!v.subPortfolio}</b></p>
                        </aura:if> 
                        
                        
                        <div class="slds-panel__section">
                            <div class="slds-file-selector slds-file-selector_files">
                                <div class="slds-file-selector__dropzone">

                                    <span>Upload CSV file :</span> &nbsp;&nbsp;

                                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                        <lightning:input type="file" label="Upload File" name="{!v.csvAsString}"
                                            multiple="false" accept=".csv" value="{!v.csvFileBody}"
                                            onchange="{! c.handleFilesChange }" />
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="slds-panel__section">
                            <tr>
                                <p><b>File Loaded : {!v.csvAsString}</b></p>
                            </tr>
                        </div>

                        <p><b>2. Click the import Products button to upload products</b></p>
                        <br></br>
                        <div>
                            <lightning:button variant="brand-outline" label="Import Products"
                                onclick="{! c.handleClickImport }" />
                        </div>
                        <br></br>
                        <br></br>
                        <p><b>3. Click on "Go to Cart" button to go to Cart</b></p>
                        <br></br>
                        <div>
                            <lightning:button variant="brand-outline" label="Go To Cart"
                                onclick="{! c.handleClickCart }" />
                        </div>
                    </div>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
    </aura:if>
</aura:component>